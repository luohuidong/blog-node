# Session

在 Cookie 中存放用户的信息是比较危险了，例如在 Cookie 中存放用户的 username，用户的 username 很有可能是他的邮箱或者是手机，总不可能将这些敏感的信息放在 Cookie 中吧。另外 Cookie 存储信息也有大小的限制。

不想在 Cookie 中存放存放用户信息，但是又想识别用户身份，那怎么解决呢？一般会在 Cookie 存一个标识，假设这个标识叫 sid (session id)，这个标识别人看不懂，也不了解是什么意思。但这个标识能够在 server 端找到对应的用户数据，这样其实就确认了请求时用户的身份了。这个解决方案就叫 Session，它是一个存储会话信息的统称。

也就是说，不通过 Cookie 来存储用户信息了，改为通过 server 端来存储用户的信息。在 server 端存储信息，一方面是存储的信息大小没有限制，即便是服务器空间不够也可以扩展。另一方面就是也避免了通过 Cookie 暴露用户敏感信息的危险。

## redis

一般 Session 是不会通过变量来存储了，因为通过变量来存储的话，是放在 Node 进程的内存中。但是操作系统分配给 Node 进程的内存是有限的，如果访问量过大的话，内存暴增，超过系统分配给 Node 进程的内存上线，进程是话挂掉的。另外一般正式上线之后，运行是多进程的，进程之间内存无法共享。

为了解决上面所说的问题，可以通过 redis 来解决。redis 是 web server 最常用的缓存数据库，数据存放在内存中。与 MySQL 相比，redis 的访问速度快。但是 redis 的成本更高，可存储的数据量更小，断电之后数据消失，当然这些都是内存的特点。

session 的以下几个特点，使得使用 redis 更为合适：

- 访问频繁对性能要求极高。 
- 可不考虑断电丢失数据的问题，因为数据存储的并不是一些丢了就不行的数据。例如 session 存储的是登录之后的用户信息，那么这些信息丢了之后，只要用户重新登录，这些信息又会添加到 session 中。
- 相比 MySQL 中存储的数据，session 存储的数据量不会太大。

redis 基本使用：

设置键值对：

```bash
set [key] [value]
```

读取值：

```bash
get [key]
```

获取所有设置了的 keys

```bash
keys *
```

删除某个 key

```bash
del [key]
```
